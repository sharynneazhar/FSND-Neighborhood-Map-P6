"use strict";function loadMapScript(){var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src=GMAP_FULL_URL,document.body.appendChild(e)}var PERSONAL=[{name:"Home",lat:38.951979,"long":-94.837693,address:["21606 W 97th Terrace","Lenexa, KS 66220"],url:""},{name:"PayIt, LLC",lat:39.090509,"long":-94.589111,address:["1812 Broadway Blvd","Kansas City, MO 66213"],url:"https://payitgov.com/"},{name:"University of Kansas",lat:38.956572,"long":-95.244782,address:["1425 Jayhawk Blvd","Lawrence, KS 66045"],url:"http://ku.edu/"}],RESTAURANTS=[{name:"Lucky Wok",category:["Asian","Chinese"],lat:38.971099,"long":-94.761319,address:["15129 W 87th St Pkwy","Lenexa, KS 66219"],contact:"(913) 894-8808",url:"http://www.luckywoklenexa.com/"},{name:"Cafe Vie",category:["Asian","Vietnamese"],lat:38.940084,"long":-94.670401,address:["10330 Metcalf Ave","Overland Park, KS 66212"],contact:"(913) 901-0565",url:"http://www.cafevieks.com/#/"},{name:"Sushi UNI",category:["Asian","Japaanese"],lat:38.970331,"long":-94.735224,address:["12841 W 87th St Pkwy","Lenexa, KS 66215"],contact:"(913) 322-8667",url:"http://sushiuni.com/"}],FS_ID="1GOXWBOA2FOS31OFVOFRNSF0OKSXFZHDLNK000TL4UH2TREM",FS_SECRET="F0RQFWMRFTTC4VLCNEXZEG5OSY42YVCS4Z3JJ5AL0C40QPY3",FS_BASE_URL="https://api.foursquare.com/v2/venues",FoursquareService={getVenues:function(e){var a=GoogleMapsService.currentLocation.lat+","+GoogleMapsService.currentLocation.lng,o=FS_BASE_URL+"/search?client_id="+FS_ID+"&client_secret="+FS_SECRET+"&v=20130815&ll="+a+"&limit=10&query="+e,n=[];$.getJSON(o,function(e){var a=e&&200===e.meta.code&&e.response.venues.length>0;a&&($.each(e.response.venues,function(e,a){var o={id:a.id||"",name:a.name||"",contact:a.contact.formattedPhone||"",url:a.url||"",lat:a.location.lat||"","long":a.location.lng||"",address:a.location.formattedAddress||""};n.push(o)}),GoogleMapsService.showMarkers(n))})}},GMAP_KEY="?key=AIzaSyCKioYCg26ODl5A4Z2K03OFkXJRT1mBpRk",GMAP_BASE_URL="http://maps.googleapis.com/maps/",GMAP_FULL_URL=GMAP_BASE_URL+"api/js"+GMAP_KEY+"&libraries=places&callback=GoogleMapsService.init",GMAP_QUERY_URL=GMAP_BASE_URL+"api/place/queryautocomplete/json"+GMAP_KEY+"&input=",DIMS={height:$(window).height(),width:$(window).width()},map=null,markers=[],GoogleMapsService={init:function(){this.currentLocation={lat:39.0997,lng:-94.5786};var e=document.getElementById("map"),a={zoom:DIMS.width<662?10:12,center:new google.maps.LatLng(this.currentLocation.lat,this.currentLocation.lng),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1};map=new google.maps.Map(e,a),this.showMarkers(RESTAURANTS);var o=map.getStreetView();o.addListener("visible_changed",function(){o.getVisible()?$("#searchbar").css("display","none"):$("#searchbar").css("display","flex")})},getMarkers:function(e){var a=new google.maps.InfoWindow;$.each(e,function(e,o){var n=new google.maps.Marker({title:o.name,position:new google.maps.LatLng(o.lat,o["long"]),map:map,animation:google.maps.Animation.DROP}),t='<div id="venue"><div class="venue-name">'+(o.name||"")+'</div><div class="venue-url"><a href="'+(o.url||"")+'"> '+(o.url||"")+'</a></div><div class="venue-address">'+(o.address[0]||"")+"<br>"+(o.address[1]||"")+'</div><div class="venue-contact">'+(o.contact||"")+"</div></div>";google.maps.event.addListener(n,"click",function(){null!==n.getAnimation()?n.setAnimation(null):(n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},750)),a.setContent(t),a.open(map,n)}),markers.push(n)})},showMarkers:function(e){this.getMarkers(e);var a=new google.maps.LatLngBounds;$.each(markers,function(e,o){a.extend(o.getPosition()),o.setMap(map)}),map.fitBounds(a)},clearMarkers:function(){$.each(markers,function(e,a){a.setMap(null)}),markers=[]},getCurrentLocation:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var a={lat:e.coords.latitude,lng:e.coords.longitude},o=new google.maps.Marker({title:"You Are Here",position:new google.maps.LatLng(a),map:map,animation:google.maps.Animation.DROP});map.getBounds().contains(o.getPosition())||map.panTo(o.getPosition()),GoogleMapsService.currentLocation=a},function(){console.log("Oops, we were unable to retrieve your current location.")}):console.log("Your browser does not support geolocation.")}};loadMapScript();var ViewModel=function(){var e=this;e.searchAddress=ko.observable(""),this.searchLocation=function(){var a=e.searchAddress();GoogleMapsService.clearMarkers(),FoursquareService.getVenues(a),e.searchAddress(""),$("input").blur()}};ko.applyBindings(new ViewModel);